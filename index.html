<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coin Duel</title>
  <style>
    :root {
      --bg-color: #1a1a1a;
      --accent-color: #4CAF50;
      --text-color: #f1f1f1;
      --card-color: #2a2a2a;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      min-height: 100vh;
      background-image: repeating-linear-gradient(45deg, var(--bg-color), var(--bg-color) 20px, var(--accent-color) 20px, var(--accent-color) 21px);
    }

    h1 {
      margin: 20px;
      color: var(--accent-color);
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      width: 100%;
      max-width: 700px;
      padding: 20px;
    }

    .card {
      background-color: var(--card-color);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
      width: 100%;
    }

    .flex-row {
      display: flex;
      justify-content: space-between;
      gap: 20px;
    }

    button, input[type="range"] {
      background-color: var(--accent-color);
      border: none;
      color: white;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
    }

    .history, .wallet, .credit {
      font-size: 0.9rem;
    }

    .slider-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #skinSelector {
      margin-top: 10px;
      display: flex;
      gap: 5px;
      flex-wrap: wrap;
    }

    .skin-option {
      width: 20px;
      height: 20px;
      border: 2px solid white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>🎲 Coin Duel</h1>
  <div class="container">

    <div class="card flex-row">
      <div class="wallet">💰 Kontostand: <span id="balance">100</span></div>
      <div class="credit">💳 Kredit: <span id="creditAmount">0</span> (<span id="creditRounds">0</span> Runden übrig)</div>
    </div>

    <div class="card">
      <div class="slider-container">
        <label for="bet">Einsatz: <span id="betValue">10</span> Coins</label>
        <input type="range" id="bet" min="1" max="100" value="10">
      </div>
      <div style="margin-top: 15px; text-align: center;">
        <button onclick="drawCard()">🎯 Würfeln</button>
        <button onclick="stopGame()">🛑 Stoppen</button>
      </div>
    </div>

    <div class="card">
      <p>🃏 Dein Punktestand: <span id="playerTotal">0</span></p>
    </div>

    <div class="card">
      <div class="slider-container">
        <label for="loanAmount">Kreditbetrag</label>
        <input type="range" id="loanAmount" min="10" max="200" value="50">
        <span id="loanVal">50</span> Coins

        <label for="loanRounds">Rückzahlungsrunden</label>
        <input type="range" id="loanRounds" min="1" max="10" value="3">
        <span id="loanRoundVal">3</span> Runden

        <button onclick="takeLoan()">📥 Kredit aufnehmen</button>
      </div>
    </div>

    <div class="card history">
      <h3>📜 Letzte Spiele</h3>
      <ul id="historyList"></ul>
    </div>

    <div class="card">
      <h3>🎨 Skins wählen</h3>
      <div id="skinSelector"></div>
    </div>
  </div>

  <script>
    let balance = 100;
    let playerTotal = 0;
    let history = [];
    let credit = { amount: 0, rounds: 0 };
    let roundCount = 0;
    let botNames = ["Zara", "Leo", "Kai", "Mira", "Tobi"];
    let currentBot = "";

    const balanceEl = document.getElementById("balance");
    const playerTotalEl = document.getElementById("playerTotal");
    const historyList = document.getElementById("historyList");
    const betSlider = document.getElementById("bet");
    const betValue = document.getElementById("betValue");
    const creditAmount = document.getElementById("creditAmount");
    const creditRounds = document.getElementById("creditRounds");

    betSlider.oninput = () => betValue.textContent = betSlider.value;
    loanAmount.oninput = () => loanVal.textContent = loanAmount.value;
    loanRounds.oninput = () => loanRoundVal.textContent = loanRounds.value;

    function drawCard() {
      const bet = parseInt(betSlider.value);
      if (playerTotal === 0 && balance < bet) return alert("Nicht genug Coins.");
      playerTotal += Math.floor(Math.random() * 10) + 1;
      playerTotalEl.textContent = playerTotal;
      if (playerTotal >= 100) {
        endGame(false);
      }
    }

    function stopGame() {
      const bet = parseInt(betSlider.value);
      if (balance < bet) return alert("Nicht genug Coins.");
      currentBot = botNames[Math.floor(Math.random() * botNames.length)];
      let botTotal = 0;
      while (botTotal < playerTotal - 1 && botTotal < 100) {
        botTotal += Math.floor(Math.random() * 10) + 1;
      }
      const win = playerTotal > botTotal && playerTotal <= 100;
      balance += win ? bet * 0.5 : -bet;
      updateUI();
      addToHistory(win, playerTotal, botTotal);
      playerTotal = 0;
      playerTotalEl.textContent = playerTotal;
      applyCreditRound();
    }

    function updateUI() {
      balanceEl.textContent = Math.round(balance);
      creditAmount.textContent = credit.amount;
      creditRounds.textContent = credit.rounds;
    }

    function takeLoan() {
      const amount = parseInt(loanAmount.value);
      const rounds = parseInt(loanRounds.value);
      balance += amount;
      credit.amount = amount * (1 + rounds / 100);
      credit.rounds = rounds;
      updateUI();
    }

    function applyCreditRound() {
      if (credit.rounds > 0) {
        credit.rounds--;
        if (credit.rounds === 0) balance -= credit.amount;
        updateUI();
      }
    }

    function addToHistory(win, playerScore, botScore) {
      history.unshift(`Du: ${playerScore} vs ${currentBot}: ${botScore} → ${win ? 'Gewonnen' : 'Verloren'}`);
      if (history.length > 5) history.pop();
      historyList.innerHTML = history.map(h => `<li>${h}</li>`).join("");
    }

    const skinOptions = [
      { bg: "#1a1a1a", accent: "#4CAF50" },
      { bg: "#0d1b2a", accent: "#e0aaff" },
      { bg: "#161616", accent: "#f72585" },
      { bg: "#001219", accent: "#94d2bd" },
      { bg: "#202c39", accent: "#fcbf49" },
      { bg: "#0b090a", accent: "#ff6d00" },
      { bg: "#14213d", accent: "#fca311" },
      { bg: "#1b263b", accent: "#ff595e" },
    ];

    const skinContainer = document.getElementById("skinSelector");
    skinOptions.forEach(skin => {
      const div = document.createElement("div");
      div.className = "skin-option";
      div.style.backgroundColor = skin.accent;
      div.onclick = () => applySkin(skin);
      skinContainer.appendChild(div);
    });

    function applySkin(skin) {
      document.documentElement.style.setProperty('--bg-color', skin.bg);
      document.documentElement.style.setProperty('--accent-color', skin.accent);
    }
  </script>
</body>
</html>
