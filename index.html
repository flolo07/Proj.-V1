<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Casino Dice Game mit Kredit</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: #000;
      background-image:
        linear-gradient(45deg, #bfa14a 25%, transparent 25%),
        linear-gradient(-45deg, #bfa14a 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, #bfa14a 75%),
        linear-gradient(-45deg, transparent 75%, #bfa14a 75%);
      background-size: 40px 40px;
      background-position: 0 0, 0 20px, 20px -20px, -20px 0px;
      color: #f0d75a;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      height: 100vh;
      padding: 20px;
      box-sizing: border-box;
      user-select: none;
    }

    .container {
      background: #111;
      border-radius: 12px;
      box-shadow: 0 0 15px #bfa14a;
      display: flex;
      padding: 20px;
      max-width: 900px;
      width: 100%;
      gap: 20px;
      color: #eee;
    }

    .left, .center, .right {
      background: #121212;
      border: 2px solid #bfa14a;
      border-radius: 12px;
      padding: 20px;
      box-sizing: border-box;
    }

    .left, .right {
      width: 180px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      font-size: 0.9rem;
      color: #f0d75a;
    }

    .center {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      color: #f0d75a;
    }

    h1 {
      margin: 0 0 10px 0;
      font-weight: 700;
      text-align: center;
      color: #f0d75a;
      text-shadow: 0 0 6px #d4af37;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 700;
    }

    input[type="number"] {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #bfa14a;
      background: #222;
      color: #f0d75a;
      font-size: 1rem;
      outline-offset: 2px;
      outline-color: #d4af37;
    }

    button {
      background: #bfa14a;
      border: none;
      padding: 12px;
      border-radius: 12px;
      color: #000;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.25s ease, transform 0.15s ease;
      user-select: none;
    }

    button:hover:not(:disabled) {
      background-color: #d4af37;
      transform: scale(1.05);
    }

    button:disabled {
      background-color: #444;
      color: #888;
      cursor: default;
      transform: none;
    }

    #scoreboard {
      background: #222;
      border-radius: 10px;
      padding: 10px;
      height: 220px;
      overflow-y: auto;
      font-size: 0.9rem;
      color: #f0d75a;
      box-shadow: inset 0 0 10px #bfa14a;
    }

    #scoreboard h2 {
      margin-top: 0;
      text-align: center;
      font-weight: 700;
      text-shadow: 0 0 5px #d4af37;
    }

    #coinsDisplay, #creditInfo {
      font-size: 1.1rem;
      text-align: center;
      font-weight: 700;
      margin-top: 10px;
      min-height: 1.2em;
      text-shadow: 0 0 6px #d4af37;
    }

    .slider-container {
      margin-top: 10px;
      width: 100%;
    }

    input[type="range"] {
      width: 100%;
      -webkit-appearance: none;
      height: 12px;
      border-radius: 10px;
      background: #333;
      outline: none;
      cursor: pointer;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #bfa14a;
      cursor: pointer;
      box-shadow: 0 0 8px #d4af37;
      transition: background-color 0.25s ease;
      margin-top: -8px;
    }
    input[type="range"]::-webkit-slider-thumb:hover {
      background-color: #d4af37;
    }
    input[type="range"]::-moz-range-thumb {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #bfa14a;
      cursor: pointer;
      box-shadow: 0 0 8px #d4af37;
      transition: background-color 0.25s ease;
    }

    .btn-group {
      display: flex;
      gap: 15px;
    }

    .points-display {
      font-size: 2.8rem;
      font-weight: 700;
      color: #d4af37;
      text-shadow: 0 0 8px #bfa14a;
      user-select: none;
      margin: 15px 0;
    }

    #messageBox {
      min-height: 3em;
      font-weight: 700;
      color: #d4af37;
      text-align: center;
      margin-bottom: 5px;
      text-shadow: 0 0 5px #bfa14a;
      min-height: 40px;
    }

    .last-games {
      font-size: 0.9rem;
      background: #222;
      border-radius: 10px;
      padding: 10px;
      height: 120px;
      overflow-y: auto;
      box-shadow: inset 0 0 10px #bfa14a;
      color: #f0d75a;
      user-select: none;
    }

    .last-games h3 {
      margin: 0 0 8px 0;
      text-align: center;
      font-weight: 700;
      text-shadow: 0 0 5px #d4af37;
    }

    .last-games p {
      margin: 2px 0;
      line-height: 1.3;
    }

    /* Scrollbar gold style */
    .last-games::-webkit-scrollbar {
      width: 8px;
    }
    .last-games::-webkit-scrollbar-thumb {
      background-color: #bfa14a;
      border-radius: 10px;
    }
    .last-games::-webkit-scrollbar-track {
      background: #222;
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- Kredit links -->
    <div class="left">
      <h2>Kredit aufnehmen</h2>
      <label for="creditAmount">Betrag (Coins)</label>
      <input type="number" id="creditAmount" min="1" step="1" placeholder="z.B. 100" />
      <label for="creditRounds">Laufzeit (Runden)</label>
      <input type="number" id="creditRounds" min="1" max="10" step="1" value="5" />
      <button id="takeCreditBtn">Kredit aufnehmen</button>
      <div id="creditInfo"></div>
    </div>

    <!-- Spiel Mitte -->
    <div class="center">
      <h1>ðŸŽ² Casino Dice Game</h1>
      <div id="messageBox">Viel GlÃ¼ck!</div>

      <div>
        <label for="betSlider">Setze deinen Einsatz (Coins): <span id="betAmount">10</span></label>
        <input type="range" id="betSlider" min="1" max="100" value="10" />
      </div>

      <div class="points-display" id="playerPoints">0</div>

      <div class="btn-group">
        <button id="drawBtn">WÃ¼rfeln</button>
        <button id="stopBtn" disabled>Stop</button>
        <button id="startBtn" disabled>Neu starten</button>
      </div>

      <div class="last-games">
        <h3>Letzte 5 Spiele</h3>
        <div id="lastGamesList">Noch keine Spiele...</div>
      </div>
    </div>

    <!-- Kontostand rechts -->
    <div class="right">
      <h2>Kontostand</h2>
      <div id="coinsDisplay">Coins: 100</div>
    </div>
  </div>

  <script>
    // Initial Werte
    let coins = 100;
    let bet = 10;
    let playerPoints = 0;
    let botPoints = 0;
    let gameActive = false;

    // Kredit Variablen
    let creditAmount = 0;
    let creditRounds = 0;
    let creditStartRound = 0;
    let currentRound = 0;

    // Bot Namen
    const botNames = ['Lenny', 'Maya', 'Max', 'Zara', 'Finn', 'Luna', 'Nico', 'Mila', 'Oskar', 'Sophie'];

    // Elemente
    const betSlider = document.getElementById('betSlider');
    const betAmountDisplay = document.getElementById('betAmount');
    const drawBtn = document.getElementById('drawBtn');
    const stopBtn = document.getElementById('stopBtn');
    const startBtn = document.getElementById('startBtn');
    const playerPointsDisplay = document.getElementById('playerPoints');
    const messageBox = document.getElementById('messageBox');
    const lastGamesList = document.getElementById('lastGamesList');
    const coinsDisplay = document.getElementById('coinsDisplay');
    const creditAmountInput = document.getElementById('creditAmount');
    const creditRoundsInput = document.getElementById('creditRounds');
    const takeCreditBtn = document.getElementById('takeCreditBtn');
    const creditInfo = document.getElementById('creditInfo');

    let lastGames = [];

    betSlider.addEventListener('input', () => {
      bet = Number(betSlider.value);
      betAmountDisplay.textContent = bet;
      messageBox.textContent = `Einsatz auf ${bet} Coins gesetzt.`;
    });

    takeCreditBtn.addEventListener('click', () => {
      const amt = parseInt(creditAmountInput.value);
      const rounds = parseInt(creditRoundsInput.value);

      if (isNaN(amt) || amt <= 0) {
        creditInfo.textContent = "Bitte einen gÃ¼ltigen Kreditbetrag eingeben.";
        return;
      }
      if (isNaN(rounds) || rounds < 1 || rounds > 10) {
        creditInfo.textContent = "Bitte Laufzeit zwischen 1 und 10 Runden wÃ¤hlen.";
        return;
      }

      creditAmount += amt;
      creditRounds = rounds;
      creditStartRound = currentRound;

      coins += amt;
      updateCoinsDisplay();

      creditInfo.textContent = `Kredit Ã¼ber ${amt} Coins aufgenommen. RÃ¼ckzahlung nach ${rounds} Runden mit ${rounds}% Zinsen.`;
      creditAmountInput.value = '';
      creditRoundsInput.value = '5';
    });

    function updateCoinsDisplay() {
      coinsDisplay.textContent = `Coins: ${coins.toFixed(2)}`;
    }

    function updateLastGames() {
      if(lastGames.length === 0){
        lastGamesList.textContent = 'Noch keine Spiele...';
        return;
      }
      lastGamesList.innerHTML = '';
      lastGames.slice(-5).reverse().forEach(game => {
        const p = document.createElement('p');
        let outcome = game.win ? `<span style="color:#7dd87d">Gewonnen</span>` : `<span style="color:#d94b4b">Verloren</span>`;
        p.innerHTML = `Du: <b>${game.playerPoints}</b>, Bot (${game.botName}): <b>${game.botPoints}</b> â€” ${outcome}, Gewinn: <b>${game.profit.toFixed(2)}</b> Coins`;
        lastGamesList.appendChild(p);
      });
    }

    function botName() {
      return botNames[Math.floor(Math.random() * botNames.length)];
    }

    // Bot zieht so lange wie du (Ã¤hnlich) aber stoppt bei >= 85
    function botPlay(playerDraws, playerValue) {
      botPoints = 0;
      let draws = 0;
      while (draws < playerDraws && botPoints < 85) {
        botPoints += Math.floor(Math.random() * 10) + 1;
        draws++;
      }
      // Bot kann nicht Ã¼ber 100 gehen
      if(botPoints > 100) botPoints = 100;
    }

    function startGame() {
      if (bet > coins) {
        messageBox.textContent = "Nicht genug Coins fÃ¼r den Einsatz!";
        return;
      }
      playerPoints = 0;
      botPoints = 0;
      gameActive = true;
      currentRound++;
      drawCount = 0;
      messageBox.textContent = "WÃ¼rfle und versuche, so nah wie mÃ¶glich an 100 zu kommen!";
      drawBtn.disabled = false;
      stopBtn.disabled = false;
      startBtn.disabled = true;
      playerPointsDisplay.textContent = "0";
    }

    let drawCount = 0;

    drawBtn.addEventListener('click', () => {
      if(!gameActive) return;
      let roll = Math.floor(Math.random() * 10) + 1;
      playerPoints += roll;
      drawCount++;
      if(playerPoints > 100){
        playerPointsDisplay.textContent = playerPoints + " (Ãœberschritten!)";
        endRound(false, "Du hast 100 Ã¼berschritten! Verloren.");
      } else if (playerPoints === 100){
        playerPointsDisplay.textContent = playerPoints;
        endRound(true, "GlÃ¼ckwunsch! Du hast genau 100 erreicht!");
      } else {
        playerPointsDisplay.textContent = playerPoints;
        messageBox.textContent = `Du hast eine ${roll} gewÃ¼rfelt. Weiter oder stoppen?`;
      }
    });

    stopBtn.addEventListener('click', () => {
      if(!gameActive) return;
      endRound(null, "Du hast gestoppt.");
    });

    startBtn.addEventListener('click', () => {
      startGame();
      creditInfo.textContent = '';
    });

    function endRound(playerWon, msg) {
      gameActive = false;
      drawBtn.disabled = true;
      stopBtn.disabled = true;
      startBtn.disabled = false;

      botPlay(drawCount, playerPoints);

      messageBox.textContent = msg;

      // Entscheidung wer gewinnt
      // Wenn playerWon === true => Spieler gewinnt
      // Wenn false => Spieler verliert
      // Wenn null => Spieler hat gestoppt, Entscheidung durch Punkte

      let winner = null; 
      if(playerWon === true) {
        winner = 'player';
      } else if(playerWon === false) {
        winner = 'bot';
      } else {
        if(playerPoints > 100) winner = 'bot';
        else if(botPoints > 100) winner = 'player';
        else if(playerPoints > botPoints) winner = 'player';
        else if(playerPoints < botPoints) winner = 'bot';
        else winner = 'bot'; // Gleichstand Bot gewinnt
      }

      let profit = 0;
      if(winner === 'player') {
        profit = bet * 1.5; // Einsatz + 50%
        coins += profit;
        messageBox.textContent += ` Du gewinnst ${profit.toFixed(2)} Coins!`;
      } else {
        coins -= bet;
        profit = -bet;
        messageBox.textContent += ` Du verlierst deinen Einsatz von ${bet} Coins.`;
      }

      // Limit Coins auf >= 0
      if(coins < 0) coins = 0;

      // Letzte Spiele speichern
      lastGames.push({
        playerPoints: playerPoints,
        botPoints: botPoints,
        botName: botName(),
        win: winner === 'player',
        profit: profit
      });

      if(lastGames.length > 5) lastGames.shift();

      updateCoinsDisplay();
      updateLastGames();
      checkCreditRepayment();
    }

    function checkCreditRepayment() {
      if(creditAmount <= 0) return;
      const roundsPlayedSinceCredit = currentRound - creditStartRound;
      if(roundsPlayedSinceCredit >= creditRounds) {
        const totalDebt = creditAmount * (1 + creditRounds / 100);
        if(coins >= totalDebt) {
          coins -= totalDebt;
          creditInfo.textContent = `Kredit Ã¼ber ${creditAmount} Coins + ${creditRounds}% Zinsen (insgesamt ${totalDebt.toFixed(2)} Coins) wurde zurÃ¼ckgezahlt.`;
          creditAmount = 0;
          creditRounds = 0;
          creditStartRound = 0;
          updateCoinsDisplay();
        } else {
          creditInfo.textContent = `Nicht genÃ¼gend Coins (${coins.toFixed(2)}) zur RÃ¼ckzahlung des Kredits (${totalDebt.toFixed(2)}). Bitte spiele weiter oder nimm einen neuen Kredit.`;
        }
      }
    }

    updateCoinsDisplay();
    updateLastGames();
  </script>
</body>
</html>
