<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CoinGame Royal Edition</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: repeating-linear-gradient(45deg, #1f1f1f, #1f1f1f 20px, #2b2b2b 20px, #2b2b2b 40px);
      color: #e2ffe2;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px;
    }
    .box {
      background-color: #003300;
      border: 2px solid gold;
      border-radius: 12px;
      padding: 20px;
      margin: 20px;
      width: 320px;
      box-shadow: 0 0 20px gold;
    }
    h1, h2 {
      color: gold;
    }
    button {
      padding: 10px;
      margin: 5px;
      border-radius: 10px;
      border: none;
      background-color: #009900;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background-color: #00cc00;
    }
    input, select {
      padding: 8px;
      margin: 5px;
      border-radius: 5px;
      border: 1px solid #555;
    }
    .flex {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }
    .history, .stats, .princess, .shop, .bonus {
      background: #001a00;
      border: 1px solid #666;
      border-radius: 10px;
      padding: 10px;
      margin-top: 10px;
    }
    .skin-toggle {
      display: inline-block;
      padding: 5px 10px;
      margin: 3px;
      border: 2px solid #ccc;
      border-radius: 5px;
      cursor: pointer;
    }
    .skin-toggle.active {
      border-color: gold;
      background-color: #004d00;
    }
    .princess img {
      width: 100px;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ² CoinGame Royal</h1>

  <div class="flex">
    <div class="box">
      <h2>Dein Konto</h2>
      <p>Coins: <span id="coins">1000</span></p>
      <p>Kredit: <span id="credit">0</span></p>
      <div>
        <input type="number" id="creditAmount" placeholder="Kreditbetrag" />
        <input type="number" id="creditRounds" placeholder="Runden" />
        <button onclick="takeCredit()">Kredit aufnehmen</button>
      </div>
    </div>

    <div class="box">
      <h2>Spielrunde</h2>
      <p>Setze Coins:</p>
      <input type="range" id="bet" min="1" max="100" value="10" />
      <span id="betDisplay">10</span>
      <br />
      <button onclick="draw()">WÃ¼rfeln</button>
      <button onclick="stopGame()">Stoppen</button>
      <p>Deine Punkte: <span id="playerScore">0</span></p>
      <p id="botName">Bot:</p>
      <p>Bot Punkte: <span id="botScore">0</span></p>
    </div>

    <div class="box history">
      <h2>Letzte Spiele</h2>
      <ul id="history"></ul>
    </div>

    <div class="box stats">
      <h2>Statistiken</h2>
      <p>Gewonnen: <span id="won">0</span></p>
      <p>Verloren: <span id="lost">0</span></p>
      <p>Letzte Auszahlung: <span id="lastBonus">Nie</span></p>
    </div>

    <div class="box bonus">
      <h2>TÃ¤glicher Bonus</h2>
      <button onclick="claimBonus()">100 Coins abholen</button>
      <p>NÃ¤chster Bonus in: <span id="bonusTimer">...</span></p>
    </div>

    <div class="box shop">
      <h2>Skins</h2>
      <div id="skins"></div>
    </div>

    <div class="box princess">
      <h2>Prinzessin</h2>
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/89/Princess_icon.png/600px-Princess_icon.png" alt="Prinzessin" />
      <p id="princessTalk">Willkommen, edler Ritter!</p>
    </div>
  </div>

  <script>
    let coins = 1000;
    let credit = 0;
    let playerScore = 0;
    let botScore = 0;
    let gameActive = true;
    let currentBet = 10;
    let creditPaybacks = [];
    let history = [];
    let skins = ["default", "blue", "red", "purple", "dots", "lines", "tiger", "neon"];
    let currentSkin = "default";
    let won = 0;
    let lost = 0;

    document.getElementById("bet").addEventListener("input", e => {
      currentBet = parseInt(e.target.value);
      document.getElementById("betDisplay").textContent = currentBet;
    });

    function updateUI() {
      document.getElementById("coins").textContent = coins;
      document.getElementById("credit").textContent = credit;
      document.getElementById("playerScore").textContent = playerScore;
      document.getElementById("botScore").textContent = botScore;
      document.getElementById("won").textContent = won;
      document.getElementById("lost").textContent = lost;
    }

    function draw() {
      if (!gameActive) return;
      if (playerScore >= 100 || currentBet > coins) return;
      playerScore += Math.floor(Math.random() * 20 + 1);
      coins -= currentBet;
      updateUI();
      if (playerScore >= 100) stopGame();
    }

    function stopGame() {
      gameActive = false;
      botScore = 0;
      let name = ["Sir Coinalot", "Botricia", "Gambletron", "Luckius", "Princess Botra"];
      let bot = name[Math.floor(Math.random() * name.length)];
      document.getElementById("botName").textContent = `Bot (${bot}):`;
      while (botScore < playerScore && botScore < 100) {
        botScore += Math.floor(Math.random() * 20 + 1);
      }
      let result = "Verloren";
      if (playerScore <= 100 && (botScore > 100 || playerScore > botScore)) {
        result = "Gewonnen";
        let reward = currentBet + Math.floor(currentBet * 0.5);
        coins += reward;
        won++;
      } else {
        lost++;
      }
      history.unshift(`${result} â€“ Du: ${playerScore}, Bot: ${botScore}`);
      if (history.length > 5) history.pop();
      document.getElementById("history").innerHTML = history.map(h => `<li>${h}</li>`).join("");
      playerScore = 0;
      botScore = 0;
      gameActive = true;
      updateUI();
      princessTalk(result === "Gewonnen" ? "Bravo! Du hast ihn geschlagen!" : "Oh nein, er war stÃ¤rker!");
      handleCreditPayback();
    }

    function takeCredit() {
      const amount = parseInt(document.getElementById("creditAmount").value);
      const rounds = parseInt(document.getElementById("creditRounds").value);
      if (isNaN(amount) || isNaN(rounds)) return;
      coins += amount;
      credit += amount;
      creditPaybacks.push({ due: rounds, total: Math.floor(amount * (1 + rounds / 100)) });
      updateUI();
    }

    function handleCreditPayback() {
      creditPaybacks.forEach(c => c.due--);
      let repaid = 0;
      creditPaybacks = creditPaybacks.filter(c => {
        if (c.due <= 0) {
          coins -= c.total;
          credit -= c.total;
          repaid += c.total;
          return false;
        }
        return true;
      });
      if (repaid > 0) princessTalk(`Du hast ${repaid} Coins zurÃ¼ckgezahlt.`);
    }

    function princessTalk(text) {
      document.getElementById("princessTalk").textContent = text;
    }

    function claimBonus() {
      const last = localStorage.getItem("lastBonus") || 0;
      const now = Date.now();
      if (now - last >= 86400000) {
        coins += 100;
        localStorage.setItem("lastBonus", now);
        document.getElementById("lastBonus").textContent = new Date(now).toLocaleString();
        princessTalk("Hier sind deine tÃ¤glichen Coins!");
        updateUI();
      } else {
        princessTalk("Morgen wieder!");
      }
    }

    function loadBonusTimer() {
      setInterval(() => {
        const last = localStorage.getItem("lastBonus") || 0;
        const next = Math.max(0, 86400000 - (Date.now() - last));
        const h = Math.floor(next / 3600000);
        const m = Math.floor((next % 3600000) / 60000);
        const s = Math.floor((next % 60000) / 1000);
        document.getElementById("bonusTimer").textContent = `${h}h ${m}m ${s}s`;
      }, 1000);
    }

    function initSkins() {
      const container = document.getElementById("skins");
      skins.forEach(skin => {
        const btn = document.createElement("div");
        btn.className = "skin-toggle";
        btn.textContent = skin;
        btn.onclick = () => {
          document.body.className = skin;
          document.querySelectorAll(".skin-toggle").forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          princessTalk(`Ich finde das ${skin}-Outfit sehr stilvoll!`);
        };
        container.appendChild(btn);
      });
    }

    // Init
    updateUI();
    initSkins();
    loadBonusTimer();
    const lastBonus = localStorage.getItem("lastBonus") || 0;
    if (lastBonus > 0) document.getElementById("lastBonus").textContent = new Date(parseInt(lastBonus)).toLocaleString();
  </script>
</body>
</html>
